import{v as De}from"./runtime-dom.esm-bundler-2ec6e87b.js";import{_ as p,$ as be,a0 as He,L as Ze,E as ye,c as H,a1 as ae,a2 as we,e as xe,A as Me,v as oe,n as K,m as le,r as O,Y as ie,P as F,w as Y,t as Z,j as ee,U as Ve,a as Q,d as We,N as je,b as fe,T as Ye,s as Xe,a3 as ve,i as qe,u as Ge,h as Qe,Z as Je}from"./index-ddc2bfca.js";import{u as _e}from"./use-id-bbaed4f6.js";import{u as X,L as pe}from"./index-e78eca4d.js";import{a as et,r as tt}from"./use-route-5b103eac.js";import{a as nt,S as at}from"./index-2925adf5.js";import{u as w,a9 as ot,Z as lt,a0 as it,L,z as Te,I as $,y as R,N as m,X as ke,Y as st,G as E,a2 as rt,x as ct,M as dt,a3 as ut,aa as ft,o as P,P as D,Q as S,R as I,T as Se,S as vt,K as he,U as te,a6 as ne,c as Ce,_ as Be}from"./_plugin-vue_export-helper-f3904dc0.js";import{o as ht}from"./on-popup-reopen-04aacf57.js";import{c as mt}from"./interceptor-8f4f549c.js";import{B as gt}from"./index-b5a9ee24.js";import{f as bt,b as yt}from"./consult-dff14eb7.js";import{I as wt}from"./index-4a8931cd.js";function xt(e,o,i){let l=0;const n=e.scrollLeft,a=i===0?1:Math.round(i*1e3/16);function r(){e.scrollLeft+=(o-n)/a,++l<a&&p(r)}r()}function _t(e,o,i,l){let n=be(e);const a=n<o,r=i===0?1:Math.round(i*1e3/16),u=(o-n)/r;function s(){n+=u,(a&&n>o||!a&&n<o)&&(n=o),He(e,n),a&&n<o||!a&&n>o?p(s):l&&p(l)}s()}function Tt(){const e=w([]),o=[];return ot(()=>{e.value=[]}),[e,l=>(o[l]||(o[l]=n=>{e.value[l]=n}),o[l])]}function kt(e,o){if(!Ze||!window.IntersectionObserver)return;const i=new IntersectionObserver(a=>{o(a[0].intersectionRatio>0)},{root:document.body}),l=()=>{e.value&&i.observe(e.value)},n=()=>{e.value&&i.unobserve(e.value)};lt(n),it(n),ye(l)}const[St,Ct]=H("sticky"),Bt={zIndex:K,position:le("top"),container:Object,offsetTop:O(0),offsetBottom:O(0)};var It=L({name:St,props:Bt,emits:["scroll","change"],setup(e,{emit:o,slots:i}){const l=w(),n=ae(l),a=Te({fixed:!1,width:0,height:0,transform:0}),r=$(()=>we(e.position==="top"?e.offsetTop:e.offsetBottom)),u=$(()=>{const{fixed:f,height:T,width:g}=a;if(f)return{width:`${g}px`,height:`${T}px`}}),s=$(()=>{if(!a.fixed)return;const f=xe(Me(e.zIndex),{width:`${a.width}px`,height:`${a.height}px`,[e.position]:`${r.value}px`});return a.transform&&(f.transform=`translate3d(0, ${a.transform}px, 0)`),f}),_=f=>o("scroll",{scrollTop:f,isFixed:a.fixed}),b=()=>{if(!l.value||ie(l))return;const{container:f,position:T}=e,g=F(l),v=be(window);if(a.width=g.width,a.height=g.height,T==="top")if(f){const y=F(f),d=y.bottom-r.value-a.height;a.fixed=r.value>g.top&&y.bottom>0,a.transform=d<0?d:0}else a.fixed=r.value>g.top;else{const{clientHeight:y}=document.documentElement;if(f){const d=F(f),B=y-d.top-r.value-a.height;a.fixed=y-r.value<g.bottom&&y>d.top,a.transform=B<0?-B:0}else a.fixed=y-r.value<g.bottom}_(v)};return R(()=>a.fixed,f=>o("change",f)),oe("scroll",b,{target:n,passive:!0}),kt(l,b),()=>{var f;return m("div",{ref:l,style:u.value},[m("div",{class:Ct({fixed:a.fixed}),style:s.value},[(f=i.default)==null?void 0:f.call(i)])])}}});const $t=Y(It),[Rt,me]=H("tab");var Pt=L({name:Rt,props:{id:String,dot:Boolean,type:String,color:String,title:String,badge:K,shrink:Boolean,isActive:Boolean,disabled:Boolean,controls:String,scrollable:Boolean,activeColor:String,inactiveColor:String,showZeroBadge:Z},setup(e,{slots:o}){const i=$(()=>{const n={},{type:a,color:r,disabled:u,isActive:s,activeColor:_,inactiveColor:b}=e;r&&a==="card"&&(n.borderColor=r,u||(s?n.backgroundColor=r:n.color=r));const T=s?_:b;return T&&(n.color=T),n}),l=()=>{const n=m("span",{class:me("text",{ellipsis:!e.scrollable})},[o.title?o.title():e.title]);return e.dot||ee(e.badge)&&e.badge!==""?m(Ve,{dot:e.dot,content:e.badge,showZero:e.showZeroBadge},{default:()=>[n]}):n};return()=>m("div",{id:e.id,role:"tab",class:[me([e.type,{grow:e.scrollable&&!e.shrink,shrink:e.shrink,active:e.isActive,disabled:e.disabled}])],style:i.value,tabindex:e.disabled?void 0:e.isActive?0:-1,"aria-selected":e.isActive,"aria-disabled":e.disabled||void 0,"aria-controls":e.controls},[l()])}});const[Lt,ge]=H("tabs");var Nt=L({name:Lt,props:{count:Q(Number),inited:Boolean,animated:Boolean,duration:Q(K),swipeable:Boolean,lazyRender:Boolean,currentIndex:Q(Number)},emits:["change"],setup(e,{emit:o,slots:i}){const l=w(),n=u=>o("change",u),a=()=>{var u;const s=(u=i.default)==null?void 0:u.call(i);return e.animated||e.swipeable?m(nt,{ref:l,loop:!1,class:ge("track"),duration:+e.duration*1e3,touchable:e.swipeable,lazyRender:e.lazyRender,showIndicators:!1,onChange:n},{default:()=>[s]}):s},r=u=>{const s=l.value;s&&s.state.active!==u&&s.swipeTo(u,{immediate:!e.inited})};return R(()=>e.currentIndex,r),ke(()=>{r(e.currentIndex)}),X({swipeRef:l}),()=>m("div",{class:ge("content",{animated:e.animated||e.swipeable})},[a()])}});const[Ie,j]=H("tabs"),At={type:le("line"),color:String,border:Boolean,sticky:Boolean,shrink:Boolean,active:O(0),duration:O(.3),animated:Boolean,ellipsis:Z,swipeable:Boolean,scrollspy:Boolean,offsetTop:O(0),background:String,lazyRender:Z,lineWidth:K,lineHeight:K,beforeChange:Function,swipeThreshold:O(5),titleActiveColor:String,titleInactiveColor:String},$e=Symbol(Ie);var zt=L({name:Ie,props:At,emits:["change","scroll","rendered","clickTab","update:active"],setup(e,{emit:o,slots:i}){let l,n,a;const r=w(),u=w(),s=w(),_=w(),b=_e(),f=ae(r),[T,g]=Tt(),{children:v,linkChildren:y}=We($e),d=Te({inited:!1,position:"",lineStyle:{},currentIndex:-1}),B=$(()=>v.length>e.swipeThreshold||!e.ellipsis||e.shrink),q=$(()=>({borderColor:e.color,background:e.background})),N=(t,c)=>{var h;return(h=t.name)!=null?h:c},se=$(()=>{const t=v[d.currentIndex];if(t)return N(t,d.currentIndex)}),G=$(()=>we(e.offsetTop)),re=$(()=>e.sticky?G.value+l:0),M=t=>{const c=u.value,h=T.value;if(!B.value||!c||!h||!h[d.currentIndex])return;const k=h[d.currentIndex].$el,x=k.offsetLeft-(c.offsetWidth-k.offsetWidth)/2;xt(c,x,t?0:+e.duration)},A=()=>{const t=d.inited;E(()=>{const c=T.value;if(!c||!c[d.currentIndex]||e.type!=="line"||ie(r.value))return;const h=c[d.currentIndex].$el,{lineWidth:k,lineHeight:x}=e,C=h.offsetLeft+h.offsetWidth/2,z={width:fe(k),backgroundColor:e.color,transform:`translateX(${C}px) translateX(-50%)`};if(t&&(z.transitionDuration=`${e.duration}s`),ee(x)){const ue=fe(x);z.height=ue,z.borderRadius=ue}d.lineStyle=z})},Pe=t=>{const c=t<d.currentIndex?-1:1;for(;t>=0&&t<v.length;){if(!v[t].disabled)return t;t+=c}},V=(t,c)=>{const h=Pe(t);if(!ee(h))return;const k=v[h],x=N(k,h),C=d.currentIndex!==null;d.currentIndex!==h&&(d.currentIndex=h,c||M(),A()),x!==e.active&&(o("update:active",x),C&&o("change",x,k.title)),a&&!e.scrollspy&&Xe(Math.ceil(ve(r.value)-G.value))},W=(t,c)=>{const h=v.find((x,C)=>N(x,C)===t),k=h?v.indexOf(h):0;V(k,c)},ce=(t=!1)=>{if(e.scrollspy){const c=v[d.currentIndex].$el;if(c&&f.value){const h=ve(c,f.value)-re.value;n=!0,_t(f.value,h,t?0:+e.duration,()=>{n=!1})}}},Le=(t,c,h)=>{const{title:k,disabled:x}=v[c],C=N(v[c],c);x||(mt(e.beforeChange,{args:[C],done:()=>{V(c),ce()}}),et(t)),o("clickTab",{name:C,title:k,event:h,disabled:x})},Ne=t=>{a=t.isFixed,o("scroll",t)},Ae=t=>{E(()=>{W(t),ce(!0)})},ze=()=>{for(let t=0;t<v.length;t++){const{top:c}=F(v[t].$el);if(c>re.value)return t===0?0:t-1}return v.length-1},Ee=()=>{if(e.scrollspy&&!n){const t=ze();V(t)}},Oe=()=>v.map((t,c)=>m(Pt,rt({key:t.id,id:`${b}-${c}`,ref:g(c),type:e.type,color:e.color,style:t.titleStyle,class:t.titleClass,shrink:e.shrink,isActive:c===d.currentIndex,controls:t.id,scrollable:B.value,activeColor:e.titleActiveColor,inactiveColor:e.titleInactiveColor,onClick:h=>Le(t,c,h)},qe(t,["dot","badge","title","disabled","showZeroBadge"])),{title:t.$slots.title})),Fe=()=>{if(e.type==="line"&&v.length)return m("div",{class:j("line"),style:d.lineStyle},null)},de=()=>{var t,c,h;const{type:k,border:x,sticky:C}=e,z=[m("div",{ref:C?void 0:s,class:[j("wrap"),{[Ye]:k==="line"&&x}]},[m("div",{ref:u,role:"tablist",class:j("nav",[k,{shrink:e.shrink,complete:B.value}]),style:q.value,"aria-orientation":"horizontal"},[(t=i["nav-left"])==null?void 0:t.call(i),Oe(),Fe(),(c=i["nav-right"])==null?void 0:c.call(i)])]),(h=i["nav-bottom"])==null?void 0:h.call(i)];return C?m("div",{ref:s},[z]):z};R([()=>e.color,je],A),R(()=>e.active,t=>{t!==se.value&&W(t)}),R(()=>v.length,()=>{d.inited&&(W(e.active),A(),E(()=>{M(!0)}))});const Ke=()=>{W(e.active,!0),E(()=>{d.inited=!0,s.value&&(l=F(s.value).height),M(!0)})},Ue=(t,c)=>o("rendered",t,c);return X({resize:()=>{A(),E(()=>{var t,c;return(c=(t=_.value)==null?void 0:t.swipeRef.value)==null?void 0:c.resize()})},scrollTo:Ae}),st(A),ht(A),ye(Ke),oe("scroll",Ee,{target:f,passive:!0}),y({id:b,props:e,setLine:A,onRendered:Ue,currentName:se,scrollIntoView:M}),()=>m("div",{ref:r,class:j([e.type])},[e.sticky?m($t,{container:r.value,offsetTop:G.value,onScroll:Ne},{default:()=>[de()]}):de(),m(Nt,{ref:_,count:v.length,inited:d.inited,animated:e.animated,duration:e.duration,swipeable:e.swipeable,lazyRender:e.lazyRender,currentIndex:d.currentIndex,onChange:V},{default:()=>{var t;return[(t=i.default)==null?void 0:t.call(i)]}})])}});const Re=Symbol(),Et=()=>ct(Re,null),[Ot,J]=H("tab"),Ft=xe({},tt,{dot:Boolean,name:K,badge:K,title:String,disabled:Boolean,titleClass:Ge,titleStyle:[String,Object],showZeroBadge:Z});var Kt=L({name:Ot,props:Ft,setup(e,{slots:o}){const i=_e(),l=w(!1),{parent:n,index:a}=Qe($e);if(!n)return;const r=()=>{var b;return(b=e.name)!=null?b:a.value},u=()=>{l.value=!0,n.props.lazyRender&&E(()=>{n.onRendered(r(),e.title)})},s=$(()=>{const b=r()===n.currentName.value;return b&&!l.value&&u(),b}),_=w(!s.value);return R(s,b=>{b?_.value=!1:Je(()=>{_.value=!0})}),R(()=>e.title,()=>{n.setLine(),n.scrollIntoView()}),dt(Re,s),()=>{var b;const f=`${n.id}-${a.value}`,{animated:T,swipeable:g,scrollspy:v,lazyRender:y}=n.props;if(!o.default&&!T)return;const d=v||s.value;if(T||g)return m(at,{id:i,role:"tabpanel",class:J("panel-wrapper",{inactive:_.value}),tabindex:s.value?0:-1,"aria-hidden":!s.value,"aria-labelledby":f},{default:()=>{var N;return[m("div",{class:J("panel")},[(N=o.default)==null?void 0:N.call(o)])]}});const q=l.value||v||!y?(b=o.default)==null?void 0:b.call(o):null;return X({id:i}),ut(m("div",{id:i,role:"tabpanel",class:J("panel"),tabindex:d?0:-1,"aria-labelledby":f},[q]),[[De,d]])}}});const xn=Y(Kt),_n=Y(zt),[Ut,U,Dt]=H("list"),Ht={error:Boolean,offset:O(300),loading:Boolean,disabled:Boolean,finished:Boolean,errorText:String,direction:le("down"),loadingText:String,finishedText:String,immediateCheck:Z};var Zt=L({name:Ut,props:Ht,emits:["load","update:error","update:loading"],setup(e,{emit:o,slots:i}){const l=w(e.loading),n=w(),a=w(),r=Et(),u=ae(n),s=()=>{E(()=>{if(l.value||e.finished||e.disabled||e.error||(r==null?void 0:r.value)===!1)return;const{offset:g,direction:v}=e,y=F(u);if(!y.height||ie(n))return;let d=!1;const B=F(a);v==="up"?d=y.top-B.top<=g:d=B.bottom-y.bottom<=g,d&&(l.value=!0,o("update:loading",!0),o("load"))})},_=()=>{if(e.finished){const g=i.finished?i.finished():e.finishedText;if(g)return m("div",{class:U("finished-text")},[g])}},b=()=>{o("update:error",!1),s()},f=()=>{if(e.error){const g=i.error?i.error():e.errorText;if(g)return m("div",{role:"button",class:U("error-text"),tabindex:0,onClick:b},[g])}},T=()=>{if(l.value&&!e.finished&&!e.disabled)return m("div",{class:U("loading")},[i.loading?i.loading():m(pe,{class:U("loading-icon")},{default:()=>[e.loadingText||Dt("loading")]})])};return R(()=>[e.loading,e.finished,e.error],s),r&&R(r,g=>{g&&s()}),ft(()=>{l.value=e.loading}),ke(()=>{e.immediateCheck&&s()}),X({check:s}),oe("scroll",s,{target:u,passive:!0}),()=>{var g;const v=(g=i.default)==null?void 0:g.call(i),y=m("div",{ref:a,class:U("placeholder")},null);return m("div",{ref:n,role:"feed",class:U(),"aria-busy":l.value},[e.direction==="down"?v:y,T(),_(),f(),e.direction==="up"?v:y])}}});const Mt=Y(Zt);const Vt=(e="doc")=>{const o=w(!1);return{loading:o,follow:async l=>{o.value=!0;try{await bt(l.id,e),l.likeFlag=l.likeFlag===1?0:1,o.value=!1}catch{o.value=!1}}}},Wt={class:"knowledge-card van-hairline--bottom"},jt={class:"head"},Yt={class:"info"},Xt={class:"name"},qt={class:"dep van-ellipsis"},Gt={class:"body"},Qt={class:"title van-ellipsis"},Jt={class:"tag"},pt={class:"intro van-multi-ellipsis--l2"},en={class:"imgs"},tn={class:"logs"},nn=L({__name:"KnoledgeCard",props:{item:null},setup(e){const{loading:o,follow:i}=Vt();return(l,n)=>{const a=wt,r=gt;return P(),D("div",Wt,[S("div",jt,[m(a,{round:"",class:"avatar",src:e.item.creatorAvatar},null,8,["src"]),S("div",Yt,[S("p",Xt,I(e.item.creatorName),1),S("p",qt,I(e.item.creatorHospatalName)+" "+I(e.item.creatorDep)+" "+I(e.item.creatorTitles),1)]),m(r,{class:"btn",size:"small",round:"",loading:he(o),onClick:n[0]||(n[0]=u=>he(i)(e.item))},{default:Se(()=>[vt(I(e.item.likeFlag===1?"已关注":"+ 关注"),1)]),_:1},8,["loading"])]),S("div",Gt,[S("h3",Qt,I(e.item.title),1),S("p",Jt,[(P(!0),D(te,null,ne(e.item.topics,(u,s)=>(P(),D("span",{key:s},"# "+I(u),1))),128))]),S("p",pt,I(e.item.content.replace(/<[^>]+>/g,"")),1),S("div",en,[(P(!0),D(te,null,ne(e.item.coverUrl,(u,s)=>(P(),Ce(a,{key:s,src:u},null,8,["src"]))),128))]),S("p",tn,[S("span",null,I(e.item.collectionNumber)+" 收藏",1),S("span",null,I(e.item.commentNumber)+" 评论",1)])])])}}});const an=Be(nn,[["__scopeId","data-v-dcc682be"]]),on={class:"knowledge-list"},ln=L({__name:"KnowledgeList",props:{type:null},setup(e){const o=e,i=w([]),l=w(!1),n=w(!1),a=w({type:o.type,current:1,pageSize:10}),r=async()=>{const u=await yt(a.value);i.value.push(...u.data.rows),l.value=!1,a.value.current>=u.data.pageTotal?n.value=!0:a.value.current++,l.value=!1};return(u,s)=>{const _=Mt;return P(),D("div",on,[m(_,{loading:l.value,"onUpdate:loading":s[0]||(s[0]=b=>l.value=b),finished:n.value,"finished-text":"没有更多了",onLoad:r},{default:Se(()=>[(P(!0),D(te,null,ne(i.value,b=>(P(),Ce(an,{key:b.id,item:b},null,8,["item"]))),128))]),_:1},8,["loading","finished"])])}}});const Tn=Be(ln,[["__scopeId","data-v-d7643de2"]]);export{xn as T,_n as a,Tn as k,Vt as u};
